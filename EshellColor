: This is not necessary as of Emacs 23

When ##ls## emits ANSI color escape sequences in [[Eshell]], then you're not calling the builtin ##eshell/ls##.  This usually happens when you use *command-line parameters* not handled by the builtin. Some init files will alias ##ls## to ##ls --color=yes##, for example.

In order for eshell to understand these commands, you have to add an output filter by customizing ##eshell-output-filter-functions## or by adding the following to your .emacs:

{{{
(require 'ansi-color)
(require 'eshell)
(defun eshell-handle-ansi-color ()
  (ansi-color-apply-on-region eshell-last-output-start
                              eshell-last-output-end))
(add-to-list 'eshell-output-filter-functions 'eshell-handle-ansi-color)
}}}

----
CategoryEshell
CategoryFaces
