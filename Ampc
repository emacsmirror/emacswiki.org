ampc (Asynchronous Music Player Controller) is an emacs application providing an interface to MPD ([http://mpd.wikia.com/ http://mpd.wikia.com/]).  ampc can be installed via the GNU [[ELPA]].  The code of ampc can be found here: 

* [http://ch.ristopher.com/git/?p=ampc;a=snapshot;h=v0.1.3;sf=tgz http://ch.ristopher.com/git/?p=ampc;a=snapshot;h=v0.1.3;sf=tgz] (stable version)
* [http://ch.ristopher.com/git/?p=ampc;a=tree http://ch.ristopher.com/git/?p=ampc;a=tree] (development tree, gitweb)
* [http://ch.ristopher.com/r/ampc http://ch.ristopher.com/r/ampc] (bare git repository)

The development history can be found here: [http://ch.ristopher.com/git/?p=ampc;a=log http://ch.ristopher.com/git/?p=ampc;a=log].

[[image:AmpcScreenShot]]

----

The development repository of ampc now features a full-blown meta-data tagger with including dired integration and tab completion.  I would appreciate it if a few people gave this a try and gave me some feedback.  I am open to suggestions of any type, not only regarding the tagger but to every aspect of ampc.  Feel free to add your comments to this page, or, even better, send me an EMail.  My EMail address can be found in the header of ampc.el.

== installation ==

If you use GNU [[ELPA]], install ampc via M-x package-list-packages RET or
(package-install 'ampc).  Otherwise, grab this file (Lisp:ampc.el) and put it somewhere in
your load-path or add the directory the file is in to it, e.g.:

<pre>
(add-to-list 'load-path "~/.emacs.d/ampc")
</pre>

Then add one autoload definition:

<pre>
(autoload 'ampc "ampc" nil t)
</pre>

Optionally bind a key to this function, e.g.:

<pre>
(global-set-key (kbd "<f9>") 'ampc)
</pre>

or

<pre>
(global-set-key (kbd "<f9>") (lambda () (interactive) (ampc "host" "port")))
</pre>

Byte-compile ampc (M-x byte-compile-file RET /path/to/ampc.el RET) to improve
its performance!

== usage ==

To invoke ampc, call the command `ampc', e.g. via M-x ampc RET.  When called
interactively, `ampc' reads host address and port from the minibuffer.  If
called non-interactively, the first argument to `ampc' is the host, the
second is the port.  Both values default to nil, which will make ampc connect
to localhost:6600.  Once ampc is connected to the daemon, it creates its
window configuration in the selected window.  To make ampc use the full frame
rather than the selected window, customise `ampc-use-full-frame'.

ampc offers three independent views which expose different parts of the user
interface.  The current playlist view, the default view at startup, may be
accessed using the `J' (that is `S-j') key.  The playlist view may be
accessed using the `K' key.  The outputs view may be accessed using the `L'
key.

=== current playlist view ===

The playlist view should look like this

<pre>
.........................
. 1      . 3  . 4  . 5  .
..........    .    .    .
. 2      .    .    .    .
.        .    .    .    .
.        .    .    .    .
.        ................
.        . 6            .
.        .              .
.........................
</pre>

Window one exposes basic information about the daemon, such as the current
state (stop/play/pause), the song currently playing, or the volume.

All windows, except the status window, contain a tabular list of items.  Each
item may be selected/marked.  There may be multiple selections.

To mark an entry, move the point to the entry and press `m' (ampc-mark).  To
unmark an entry, press `u' (ampc-unmark).  To unmark all entries, press `U'
(ampc-unmark-all).  To toggle marks, press `t' (ampc-toggle-marks).  Pressing
`<down-mouse-1>' with the mouse mouse cursor on a list entry will move point
to the entry and toggle the mark.  To navigate to the next entry, press `n'
(ampc-next-line).  Analogous, pressing `p' (ampc-previous-line) moves the
point to the previous entry.

Window two shows the current playlist.  The song that is currently played by
the daemon, if any, is highlighted.  To delete the selected songs from the
playlist, press `d' (ampc-delete).  Pressing `<down-mouse-3>' will move the
point to the entry under cursor and delete it from the playlist.  To move the
selected songs up, press `<up>' (ampc-up).  Analogous, press `<down>'
(ampc-down) to move the selected songs down.  Pressing `<return>'
(ampc-play-this) or `<down-mouse-2>' will play the song at point/cursor.

Windows three to five are tag browsers.  You use them to narrow the song
database to certain songs.  Think of tag browsers as filters, analogous to
piping `grep' outputs through additional `grep' filters.  The property of the
songs that is filtered is displayed in the header line of the window.

Window six shows the songs that match the filters defined by windows three to
five.  To add the selected song to the playlist, press `a' (ampc-add).
Pressing `<down-mouse-3>' will move the point to the entry under the cursor
and execute `ampc-add'.  These key bindings works in tag browsers as well.
Calling `ampc-add' in a tag browser adds all songs filtered up to the
selected browser to the playlist.

The tag browsers of the (default) current playlist view (accessed via `J')
are `Genre' (window 3), `Artist' (window 4) and `Album' (window 5).  The key
`M' may be used to fire up a slightly modified current playlist view.  There
is no difference to the default current playlist view other than that the tag
browsers filter to `Genre' (window 3), `Album' (window 4) and `Artist'
(window 5).  Metaphorically speaking, the order of the `grep' filters defined
by the tag browsers is different.

=== playlist view ===

The playlist view resembles the current playlist view.  The window, which
exposes the playlist content, is split, though.  The bottom half shows a list
of stored playlists.  The upper half does not expose the current playlist
anymore.  Instead, the content of the selected (stored) playlist is shown.
All commands that used to work in the current playlist view and modify the
current playlist now modify the selected (stored) playlist.  The list of
stored playlists is the only view in ampc that may have only one marked
entry.

Again, the key `<' may be used to setup a playlist view with a different
order of tag browsers.

=== outputs view ===

The outputs view contains a single list which shows the configured outputs of
mpd.  To toggle the enabled property of the selected outputs, press `a'
(ampc-toggle-output-enabled) or `<mouse-3>'.

=== global keys ===

Aside from `J', `M', `K', `<' and `L', which may be used to select different
views, ampc defines the following global keys, which may be used in every
window associated with ampc:

`k' (ampc-toggle-play): Toggle play state.  If mpd does not play a song
already, start playing the song at point if the current buffer is the
playlist buffer, otherwise start at the beginning of the playlist.  With
prefix argument 4, stop player rather than pause if applicable.

`l' (ampc-next): Play next song.
`j' (ampc-previous): Play previous song

`c' (ampc-clear): Clear playlist.
`s' (ampc-shuffle): Shuffle playlist.

`S' (ampc-store): Store playlist.
`O' (ampc-load): Load selected playlist in the current playlist.
`R' (ampc-rename-playlist): Rename selected playlist.
`D' (ampc-delete-playlist): Delete selected playlist.

`y' (ampc-increase-volume): Increase volume.
`M-y' (ampc-decrease-volume): Decrease volume.
`h' (ampc-increase-crossfade): Increase crossfade.
`M-h' (ampc-decrease-crossfade): Decrease crossfade.

`e' (ampc-toggle-repeat): Toggle repeat state.
`r' (ampc-toggle-random): Toggle random state.
`f' (ampc-toggle-consume): Toggle consume state.

`P' (ampc-goto-current-song): Select the current playlist window and move
point to the current song.

`T' (ampc-trigger-update): Trigger a database update.
`Z' (ampc-suspend): Suspend ampc.
`q' (ampc-quit): Quit ampc.

The keymap of ampc is designed to fit the QWERTY United States keyboard
layout.  If you use another keyboard layout, feel free to modify
`ampc-mode-map'.  For example, I use a regular QWERTZ German keyboard
(layout), so I modify `ampc-mode-map' in my init.el like this:

<pre>
(eval-after-load 'ampc
  '(flet ((substitute-ampc-key
           (from to)
           (define-key ampc-mode-map to (lookup-key ampc-mode-map from))
           (define-key ampc-mode-map from nil)))
     (substitute-ampc-key (kbd "z") (kbd "Z"))
     (substitute-ampc-key (kbd "y") (kbd "z"))
     (substitute-ampc-key (kbd "M-y") (kbd "M-z"))
     (substitute-ampc-key (kbd "<") (kbd ";"))))
</pre>

If ampc is suspended, you can still use every interactive command that does
not directly operate on or with the user interace of ampc.  For example it is
perfectly fine to call `ampc-increase-volume' or `ampc-toggle-play' via M-x
RET.  To display the information that is displayed by the status window of
ampc, call `ampc-status'.
